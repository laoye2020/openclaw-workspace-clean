# 2026-02-12 - 萨勒芬妮v2训练完成日

## 🎙️ 萨勒芬妮v2语音模型训练

### 今日完成

1. **S1训练完成** ✅
   - 从e99恢复，训练至e199/200
   - 最终Loss: 45.853
   - Top-3准确率: 98.0%
   - 模型文件: `epoch=199-step=1100.ckpt` (476MB)

2. **S2训练完成** ✅
   - 启动时间: 19:05（GPU修复后重启）
   - 完成: Epoch 200/200
   - 最终Loss: 2.29
   - 模型文件: 
     - G_233333333333.pth (622MB)
     - D_233333333333.pth (561MB)

3. **修复的问题**
   - 缺少`if_save_latest`参数 → 已添加
   - 缺少`if_save_every_weights`参数 → 已添加
   - 缺少`name`参数 → 已添加`"seraphine_s2_v2"`
   - GPU0 Unknown Error → 老爷重启后修复

### 遇到的推理问题

**语音合成测试失败：**
1. PyTorch 2.5.1 安全漏洞限制（CVE-2025-32434）
   - 需要 PyTorch 2.6+ 才能使用 `torch.load`
   - 但GPT-SoVITS与PyTorch 2.6可能存在兼容性问题

2. 代码语法错误 → 已修复
   - `inference_webui.py` 第475行
   - `TTS.py` 第658行
   - `export_torch_script_v3v4.py` 第536行

3. 依赖版本冲突
   - transformers 与 peft 版本不兼容
   - 需要降级 transformers 到 4.30.0

### 当前状态

| 阶段 | 状态 | 进度 |
|------|------|------|
| S1 | ✅ 完成 | 199/199 epochs |
| S2 | ✅ 完成 | 200/200 epochs |
| 推理 | ❌ 待修复 | 环境兼容性问题 |

### 模型文件位置

```
~/.openclaw/tools/seraphine-voice-v2/
├── exp/s1/ckpt/epoch=199-step=1100.ckpt (454MB)
├── exp/logs_s2_v1/G_233333333333.pth (594MB)
└── exp/logs_s2_v1/D_233333333333.pth (535MB)
```

### 待解决问题

**方案1：降级transformers**
```bash
cd ~/.openclaw/tools/GPT-SoVITS
source venv/bin/activate
pip install transformers==4.30.0 --force-reinstall
```

**方案2：使用Docker**
```bash
docker pull registry.cn-hangzhou.aliyuncs.com/funaudiogpt/gpt-sovits
```

**方案3：手动加载模型测试**
使用GPT-SoVITS官方WebUI手动加载训练好的模型

---

## 总结

✅ **训练大获成功！** S1和S2都已完成200轮训练，模型文件已保存。

❌ **推理遇阻：** 环境依赖版本冲突，需要额外配置才能使用训练好的模型。

💡 **建议：** 老爷可先尝试官方WebUI手动加载模型，或等待环境修复后再测试语音效果。
